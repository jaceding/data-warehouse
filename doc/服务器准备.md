# 服务器准备

## 服务器信息

|   名称   |      ip      |  系统   | 内存 | 硬盘 |
| :------: | :----------: | :-----: | :--: | :--: |
| hadoop12 | 192.168.3.12 | Centos7 |  8G  | 400G |
| hadoop13 | 192.168.3.13 | Centos7 |  8G  | 400G |
| hadoop14 | 192.168.3.14 | Centos7 |  8G  | 400G |

## 常用软件安装

### vim

```shell
sudo yum -y vim*
```

### net-tools

```shell
sudo yum install net-tools
```

### ntp

```shell
# 安装同步工具
sudo yum -y install ntp ntpdate
# 设置时间同步
sudo ntpdate cn.pool.ntp.org
# 将系统时间写入硬件时间
sudo hwclock --systohc
# 查看系统时间
timedatectl
```

### ssh

```shell
# 查看状态
sudo systemctl status sshd.service
# 启动服务
sudo systemctl start sshd.service
# 重启服务
sudo systemctl restart sshd.service
# 开机自启
sudo systemctl enable sshd.service
```

### pdsh

```shell
# 先将安装包上传至/opt目录下
# 解压
sudo tar -jxvf pdsh-2.26.tar.bz2
cd pdsh-2.26
./configure \
--without-rsh \
--with-ssh \
--with-machines=/etc/pdsh/machines \
--with-dshgroups \
--with-netgroup \
--with-timeout=10
make && make install
# 设置pdsh主机
vim /etc/pdsh/machines
# 添加如下内容，注意：如果无法保存，试一下在先创建 /etc/pdsh 目录
hadoop12
hadoop13
hadoop14
# 检查是否默认使用ssh，如果不是，自行百度设置
pdsh -V
```

## 修改yum源

```shell
# 先安装wget方便后续下载
sudo yum install -y wget
# 进入目录
cd /etc/yum.repos.d
# 备份旧的配置文件
sudo mv CentOS-Base.repo CentOS-Base.repo.bak
# 下载阿里的源文件
sudo wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/Centos-7.repo
# 清理缓存
yum clean all
# 生成缓存
yum makecache
```

## 配置静态ip地址

```shell
# 进入目录
cd /etc/sysconfig/network-scripts/
# 修改网卡配置
sudo vim ifcfg-ens33
```

**需要作如下修改**：

1. BOOTPROTO=static

2. ONBOOT=yes

3. 在最后加上几行，IP地址、子网掩码、网关、dns服务器

   ```shell
   # 设置IP地址
   IPADDR=192.168.3.12
   # 设置子网掩码
   NETMASK=255.255.255.0
   # 设置网关
   GATEWAY=192.168.3.1
   # 设置主DNS
   DNS1=8.8.8.8
   # 设置备DNS
   DNS2=114.114.114.114
   ```

**最后重启一下网络服务即可**

```shell
sudo systemctl restart network
```

## 修改主机名

```shell
hostnamectl --static set-hostname hadoop12
```

## 修改hosts

```shell
sudo vim /etc/hosts
# 添加如下内容：
192.168.3.12 hadoop12
192.168.3.13 hadoop13
192.168.3.14 hadoop14
```

## 关闭防火墙

```shell
sudo systemctl stop firewalld
# 关闭开机自启动
sudo systemctl disable firewalld
```

## 时间同步

```shell
# 添加定时任务，每隔十分钟同步一次，crontab -e添加
*/10 * * * * ntpdate cn.pool.ntp.org
```

## SSH免密码登录

```shell
# 三台都需执行
ssh-keygen -t rsa -P '' -f ~/.ssh/id_rsa
cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys
chmod 600 ~/.ssh/authorized_keys
# 免密码登录自身，(首次需输入yes)
ssh localhost
# 免密码登录其他机器，三台都需要执行
ssh-copy-id -i ~/.ssh/id_rsa.pub hadoop12
ssh-copy-id -i ~/.ssh/id_rsa.pub hadoop13
ssh-copy-id -i ~/.ssh/id_rsa.pub hadoop14
# 登录测试
ssh hadoop12
ssh hadoop13
ssh hadoop14
# 退出登录
exit
```

## 安装jdk

```shell
# 切换目录
cd /usr/local 
# 解压
tar -zxvf jdk-8u231-linux-x64.tar.gz

# 修改配置文件
vim /etc/profile.d/my_env.sh
# 在末尾添加，JAVA_HOME根据实际情况修改
# java environment
JAVA_HOME=/usr/local/jdk1.8.0_231
JRE_HOME=$JAVA_HOME/jre
PATH=$PATH:$JAVA_HOME/bin:$JRE_home/bin:$PATH
CLASSPATH=.:$JAVA_HOME/lib/tools.jar:$JAVA_HOME/lib/dt.jar:$CLASSPATH
export JAVA_HOME
export JRE_HOME
export PATH
export CLASSPATH

# 使配置文件生效
source /etc/profile
```